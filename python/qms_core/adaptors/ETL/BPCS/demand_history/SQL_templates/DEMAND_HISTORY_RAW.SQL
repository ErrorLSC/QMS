SELECT   
        H.HDTYP,
        H.HCUST,
        L.LODTE,
        L.LORD,
        L.LLINE,
        TRIM(L.LPROD) AS ITEMNUM,
        L.LQORD,
        L.LRDTE,
        L.LSDTE,
        TRIM(L.LWHS) AS WAREHOUSE,
        JSB.SBSWKT
    FROM JPNPRDF.ECL L
    INNER JOIN JPNPRDF.ECH H ON L.LORD = H.HORD
    INNER JOIN JPNPRDF.IIM IIM ON L.LPROD = IIM.IPROD
    LEFT JOIN JSB ON H.HORD = JSB.SBHORD
    WHERE 
        L.LODTE > 20240101
        AND L.LODTE >= CAST(TO_CHAR(CURRENT DATE - 6 MONTHS, 'YYYYMMDD') AS INTEGER)
        AND L.LPROD NOT LIKE 'FA%'
        AND IIM.IITYP != '6'
        AND (JSB.SBSWKT IS NULL OR JSB.SBSWKT IN ('ASX', 'ASY', 'GW ', 'KIT', 'REP', 'SPW'))
        AND TRIM(L.LWHS) IN ('5', '6')
        AND NOT (JSB.SBSWKT IN ('ASY', 'KIT') AND L.LQORD < 0)
        AND NOT (H.HCUST > 1000 AND H.HCUST < 10000 AND H.HCUST != 9125)